{
  "name": "Framework Compliance Enforcement",
  "version": "3.2.0",
  "description": "Enforces mandatory compliance with Framework Rules (PreToolUse + PostToolUse)",
  "hooks": {
    "PreToolUse": [
      {
        "name": "Validate File Authorization Before Write",
        "description": "RULE 2: Check file_manifest.json BEFORE Write operation (proactive)",
        "matcher": "Write",
        "hooks": [
          {
            "type": "command",
            "command": "bash scripts/pre_write_check.sh"
          }
        ]
      },
      {
        "name": "Enforce State Tracking Before Operations",
        "description": "RULE 14: Verify state files updated BEFORE allowing next operation (proactive)",
        "matcher": "Read|Write|Edit|Bash",
        "hooks": [
          {
            "type": "command",
            "command": "bash scripts/pre_operation_state_check.sh"
          }
        ]
      },
      {
        "name": "Enforce Context Management Before Operations",
        "description": "RULE 10: Block if context exceeds 75% emergency threshold (proactive)",
        "matcher": "Read|Write|Edit|Bash",
        "hooks": [
          {
            "type": "command",
            "command": "bash scripts/pre_context_check.sh"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "name": "Validate State Tracking After Edits",
        "description": "Verifies state files updated after Read/Edit/Write operations (RULE 14)",
        "matcher": "Read|Edit|Write",
        "hooks": [
          {
            "type": "command",
            "command": "bash scripts/validate_compliance.sh file_operation"
          }
        ]
      },
      {
        "name": "Validate State Tracking After Bash",
        "description": "Verifies state files updated after Bash operations (RULE 14)",
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "bash scripts/validate_compliance.sh bash_operation"
          }
        ]
      },
      {
        "name": "Validate Test Results After Test Commands",
        "description": "RULE 18: Validates test coverage ≥80% and 100% passing after test commands",
        "matcher": "Bash.*(pytest|jest|npm test|yarn test|go test|cargo test)",
        "hooks": [
          {
            "type": "command",
            "command": "bash scripts/post_test_validation.sh \"$COMMAND\" \"$OUTPUT\""
          }
        ]
      },
      {
        "name": "Detect Documentation Changes After Code Edits",
        "description": "RULE 19: Warns if code files modified without corresponding doc updates",
        "matcher": "Write.*\\.(py|js|ts|go|rs|java|cpp)|Edit.*\\.(py|js|ts|go|rs|java|cpp)",
        "hooks": [
          {
            "type": "command",
            "command": "bash scripts/post_doc_validation.sh \"$FILE_PATH\""
          }
        ]
      }
    ]
  },
  "enforcement_level": "mandatory",
  "rules_enforced": [
    "RULE 2: Named Files Only (PreToolUse - blocks unauthorized files BEFORE creation)",
    "RULE 10: Context Management (PreToolUse - blocks if context >75%)",
    "RULE 14: State Tracking (PreToolUse - blocks if state files stale + PostToolUse validates after)",
    "RULE 15: Visible Tracking (PostToolUse - reminds to display checkpoint box)",
    "RULE 17: Next Steps (PostToolUse - reminds to display at end of response)",
    "RULE 18: Mandatory Testing (PostToolUse - validates coverage ≥80% and 100% passing)",
    "RULE 19: Auto-Documentation (PostToolUse - warns if code changes without doc updates)"
  ],
  "notes": [
    "NEW in v2.0.0: PreToolUse hooks validate BEFORE tool execution (proactive)",
    "PostToolUse hooks run AFTER tool completion (reactive)",
    "PreToolUse can block operations by exiting with error code",
    "PostToolUse provides feedback Claude MUST address",
    "Hook output treated as user feedback per Claude Code system instructions",
    "If PreToolUse validation fails, tool execution is blocked",
    "If PostToolUse validation fails, Claude sees error and MUST fix before continuing"
  ],
  "version_history": {
    "3.2.0": "Added PostToolUse hook for RULE 19 documentation sync detection (warns on code changes without doc updates)",
    "3.1.0": "Added PostToolUse hook for RULE 18 test validation (coverage ≥80%, 100% passing)",
    "3.0.0": "Added PreToolUse hooks for RULE 10 and RULE 14 proactive enforcement (prevents persistent violations)",
    "2.0.0": "Added PreToolUse hook for RULE 2 proactive enforcement",
    "1.0.0": "Initial PostToolUse hooks for RULE 14, 15, 17"
  }
}
